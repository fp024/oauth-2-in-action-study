# 3μ¥. κ°„λ‹¨ν• OAuth ν΄λΌμ΄μ–ΈνΈ



> κ·Έλ°λ°.. `μΈκ°€ μ½”λ“ κ·ΈλνΈ νƒ€μ…` μ΄κ² λ­μ§€? 
>
> * p60μ λ°©μ‹ μμ²΄λ¥Ό λ§ν•λ” κ²ƒ κ°™λ‹¤. μ±…μ κ·Έλ¦Ό 2.1 `μΈκ°€ μ½”λ“ κ·ΈλνΈ` ν•­λ©μ„ λ³΄λ„λ΅ ν•μ!
> * Part 2 OAuth 2 ν™κ²½ κµ¬μ¶•μ—μ„λ” μΈκ°€ μ½”λ“ κ·ΈλνΈ νƒ€μ… μμ²΄λ¥Ό κµ¬ν„ν•λ‹¤λ” κ²ƒ κ°™λ‹¤.
> * μμ  μμ •μ „μ—λ” ν•λ² prettier λλ¦¬κ³  μ‹μ‘ν•μ!





## 3.1 μΈκ°€ μ„λ²„μ— OAuth ν΄λΌμ΄μ–ΈνΈ λ“±λ΅

* ch-3-ex-1 ν”„λ΅μ νΈμ client.js μμ •.



## 3.2 μΈκ°€ μ½”λ“ κ·ΈλνΈ νƒ€μ…μ„ μ΄μ©ν•΄ ν† ν° μ–»κΈ°

### 3.2.1 μΈκ°€ μ”μ²­ λ³΄λ‚΄κΈ°



### 3.2.2 μΈκ°€ μ”μ²­μ— λ€ν• μ‘λ‹µ μ²λ¦¬

* κ΄€λ ¨ μ»¤λ°‹
  * https://github.com/fp024/oauth-in-action-code/commit/a885e87ff9e342e298c8e0a8af7de8e99999a39f



### 3.2.3 ν¬λ΅μ¤ μ‚¬μ΄νΈ κ³µκ²©μ„ λ°©μ§€ν•κΈ° μ„ν• state νλΌλ―Έν„° μ¶”κ°€

* κ΄€λ ¨ μ»¤λ°‹
  * https://github.com/fp024/oauth-in-action-code/commit/dcc83ca782ca67203a3c73fe4799fa402ea304be





## 3.3 λ³΄νΈλ λ¦¬μ†μ¤μ— μ ‘κ·Όν•κΈ° μ„ν• ν† ν° μ‚¬μ©

* ν΄λΌμ΄μ–ΈνΈλ” μ•΅μ„Έμ¤ ν† ν°μ„ μ΄μ©ν•΄ λ³΄νΈλ λ¦¬μ†μ¤λ¥Ό μ”μ²­
* OAuth μ¤ν©μ—μ„ κ¶μ¥ν•λ” λ°©λ²•μ€...
  * Authorization HTTP ν—¤λ”μ— μ•΅μ„Έμ¤ ν† ν°μ„ λ‹΄μ•„ μ „λ‹¬



#### Bearer ν† ν°μ„ μ „λ‹¬ν•λ”λ°©λ²•

* HTTP Authorization ν—¤λ”λ¥Ό μ΄μ©ν•λ” λ°©λ²• (β¨ κ¶μ¥ν•λ”λ°©λ²•)
  * μΌλ¶€ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‚¬μ©ν•μ§€ λ»ν•  μ μμ§€λ§ κ°€μ¥ ν° μ μ—°μ„±κ³Ό λ³΄μ•μ„± μ κ³µ
* νΌ μΈμ½”λ”©λ μ”μ²­ νλΌλ―Έν„°λ΅ μ „λ‹¬ν•λ” λ°©λ²• 
  * POST μ „μ†΅λ§ μ‚¬μ©κ°€λ¥
* URL μΈμ½”λ”©λ μ§μ νλΌλ―Έν„°λ΅ μ „λ‹¬ν•λ” λ°©λ²•
  * URLμ— λ…Έμ¶λλ―€λ΅ μ‹¤μλ΅ μ„λ²„μ λ΅κ·Έμ— μ—‘μ„Έμ¤ ν† ν° κ°’μ΄ λ†€μ¶λ  μ μμ.



* κ΄€λ ¨ μ»¤λ°‹
  * https://github.com/fp024/oauth-in-action-code/commit/997bdd66cabf4474dd6aa5deac2d6003d957bc9b



#### μ¶”κ°€ μ—°μµ κ³Όμ 

* [x] μ”μ²­μ΄ μ‹¤ν¨ ν–μ„ λ•... μλ™μΌλ΅ μ‚¬μ©μμ—κ² ν΄λΌμ΄μ–ΈνΈλ¥Ό μΈκ°€ν•΄λ‹¬λΌλ” μ”μ²­μ„ ν•λ„λ΅ μμ •ν•΄λ³Ό κ²ƒ!

  * λ‹¨μν•κ² κ΄€λ ¨ λ¶€λ¶„μ— ν΄λΌμ΄μ–ΈνΈμ `/authorize`λ΅ λ¦¬λ‹¤μ΄λ ‰νΈν•λ” μ½”λ“λ¥Ό λ„£μ—λ‹¤.

    ```javascript
    res.redirect("/authorize");
    ```

    

  * κ΄€λ ¨ μ»¤λ°‹

    * https://github.com/fp024/oauth-in-action-code/commit/5dcab8b82c0ed0d0138824870f92992c4214fad7





## 3.4 μ•΅μ„Έμ¤ ν† ν° κ°±μ‹ 

OAuthμ—μ„λ” μ•΅μ„Έμ¤ ν† ν°μ΄ λ§λ£λλ” κ²½μ°...

`λ¦¬ν”„λ μ‹ ν† ν°μ„` μ΄μ©ν•μ—¬ μ‚¬μ©μμ κ°μ…μ—†μ΄λ„ μƒλ΅μ΄ μ•΅μ„Έμ¤ ν† ν°μ„ μ–»μ„ μ μλ” λ°©λ²•μ„ μ κ³µν•¨.

* μƒλ΅μ΄ ν”„λ΅μ νΈ
  * **ch-3-ex-2**
  
  * μ ν¨ν•μ§€ μ•μ€ ν† ν° λ™μ‘μ„ ν™•μΈν•λ ¤λ©΄ λ°”λ΅ `Get Protected Resource` λ²„νΌμ„ λλ¬ ν™•μΈν•λ©΄ λλ‹¤.
  
    



#### μ§€κΈ κ°–κ³  μλ” ν† ν°μ΄ μ ν¨ν• κ²ƒμΌκΉ?

* μΌλ‹¨ μ‚¬μ©ν•΄λ³΄κ³  λ¬΄μ¨μΌμ΄ λ°μƒν•λ”μ§€ ν™•μΈν•λ” κ²ƒμ„.
* μΈκ°€μ„λ²„λ” expires_in μ„ νƒμ  ν•„λ“λ¥Ό μ‚¬μ©ν•΄ ν† ν°μ μμƒ λ§λ£ μ‹κ°„μ— λ€ν• ννΈλ¥Ό μ κ³µν•΄μ¤.



* κ΄€λ ¨ μ»¤λ°‹
  * https://github.com/fp024/oauth-in-action-code/commit/d5115383d8fb096ea138f433cf7346508d0f6e8c
  * https://github.com/fp024/oauth-in-action-code/commit/406120c7caa564647d7d538fc0d34709a97c62e9
  * https://github.com/fp024/oauth-in-action-code/commit/e8a3666b5f9ec3da5987bba22172323c37ba1d30



**μ°Έκ³ :**

* λ¦¬ν”„λ μ‹ ν† ν°μ„ ν†µν•΄ μ—‘μ„Έμ¤ ν† ν°μ„ μ„±κ³µμ μΌλ΅ λ°›μ€ μƒνƒλΌλ©΄... λ‹¤μ‹ ν…μ¤νΈλ¥Ό ν•λ ¤λ©΄ client.jsλ¥Ό λ‹¤μ‹ μ¬μ‹μ‘ν•΄μ•Όν•λ‹¤. client.js ν”„λ΅μ„Έμ¤μ— μ¬λ°”λ¥Έ ν† ν°μ΄ λ“¤μ–΄κ°„ μƒνƒμ—¬μ„, λΈλΌμ°μ €λ¥Ό μƒλ΅κ³ μΉ¨ ν•λ©΄ λλ” κ²ƒμ€ μ•„λ‹μ§€λΌκ³  μ°©κ°ν•λ©΄ μ•λ¨..π“
* λ¦¬ν”„λ μ‹ ν† ν°μ„ μΈκ°€ μ„λ²„μ—μ„ μ•κ³ μλ‹¤. μμ μ—μ„λ” μΈκ°€μ„λ²„ μ‹¤ν–‰μ‹μ μ— ν•΄λ‹Ή ν΄λΌμ΄μ–ΈνΈ IDμ— λ€ν• λ¦¬ν”„λ μ‹ν† ν°μ„ μλ™μΌλ΅ μ΄κΈ°ν™”ν•΄μ£Όλ” λ¶€λ¶„μ΄ μλ‹¤.
* μ—‘μ„Έμ¤ ν† ν°μ΄ μ‹¤ν¨ν–λ‹¤κ³  κ·Έλƒ¥ λλ‚΄λ©΄ μ•λ¨.  μ΄λ•λ” μ—‘μ„Έμ¤ν† ν°μ΄ μ—†λ” μƒνƒκ°€ λλ―€λ΅ μ‚¬μ©μμ—κ² ν΄λΌμ΄μ–ΈνΈλ¥Ό λ‹¤μ‹ μΈκ°€ν•΄λ‹¬λΌκ³  μ”μ²­ν•  μ μμ.



## μ”μ•½

* ...
* ν΄λΌμ΄μ–ΈνΈκ°€ λ¦¬ν”„λ μ‹ ν† ν°μ„ μ‚¬μ©ν•  μ μλ‹¤λ©΄, ν΄λΌμ΄μ–ΈνΈλ” μ‚¬μ©μ κ°μ…μ—†μ΄ λ¦¬ν”„λ μ‹ ν† ν°μΌλ΅ μƒλ΅μ΄ ν† ν°μ„ μ–»μ„ μ μμ.
* OAuth 2.0 Bearer ν† ν°μ„ μ΄μ©ν•λ” κ²ƒμ€ λ§¤μ° κ°„λ‹¨ν•¨. HTTP μ”μ²­μ„ ν•  λ•λ§λ‹¤ κ°„λ‹¨ν• HTTP ν—¤λ”(Authorization ν—¤λ”)λ§ μ¶”κ°€ν•λ©΄ λ¨



## μκ²¬

* Node, Expressλ¥Ό μ λ°λΌλ„ μ–΄λμ •λ„ λ”°λΌ κ° μ μμ„ κ²ƒ κ°™λ‹¤.
* μ¤‘μ”ν• λ¶€λ¶„λ§ λΉ λ©”μ„λ“λ΅ λ§λ“¤μ–΄μ£Όμ…”μ„ λ¬Έμ  λ‹µ μ±„μ°λ“―μ΄ μ§„ν–‰ν–λ‹¤. π„ κ΄μ°®μ€ κ²ƒ κ°™μ.



## μ •μ¤ν‘

* ...
